@page "/"
@using EventEaseAppBlazor.Models
@inject EventEaseAppBlazor.Services.EventService EventService
@inject NavigationManager NavigationManager

<h3>Eventos</h3>

@foreach (var evento in eventos)
{
    <div>
        <b>@evento.Nombre</b>
        <button @onclick="() => VerDetalles(evento.Id)">Ver detalles</button>
        <button @onclick="() => EliminarEvento(evento.Id)">Eliminar</button>
    </div>
}

<input placeholder="Nombre" @bind="nuevoEvento.Nombre" />
<button @onclick="AgregarEvento">Agregar</button>

@code {
    private List<Event> eventos = new();
    private Event nuevoEvento = new Event();

    protected override void OnInitialized()
    {
        eventos = EventService.GetAll();
    }

    private void VerDetalles(int id)
    {
        NavigationManager.NavigateTo($"/eventdetails/{id}");
    }

    private void AgregarEvento()
    {
        if (!string.IsNullOrWhiteSpace(nuevoEvento.Nombre))
        {
            EventService.Add(new Event { Nombre = nuevoEvento.Nombre });
            eventos = EventService.GetAll();
            nuevoEvento = new Event();
            StateHasChanged();
        }
    }

    private void EliminarEvento(int id)
    {
        EventService.Remove(id);
        eventos = EventService.GetAll();
        StateHasChanged();
    }
}